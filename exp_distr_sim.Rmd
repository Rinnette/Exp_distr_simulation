---
title: "Investigation of the exponential distribution"
author: "Rinnette Ramdhanie"
date: "8 November 2019"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r setupLib, warning = FALSE, message = FALSE}
        library(ggplot2)
        library(ggpubr)
        lambda <- 0.2
        numexp <- 40
```

## Overview



## Simulating the distributions

Exponential distribution
lambda = 0.2 (rate parmeter for the exp distr)
investigating the averages of 40 exponentials
Doing 1000 simulations


```{r simDistr}
        ## Simulate 40 exponentials one thousand times and find the average means and variances.
                means <- NULL
                for (i in 1:1000) means = c(means, mean(rexp(40, 0.2)))
        
                vars <- NULL
                for (i in 1:1000) vars = c(vars, sd(rexp(40, 0.2))^2)

        ## Convert to dataframes to be used in ggplot2
                mns <- data.frame(means)
                vrs <- data.frame(vars)
```

## Comparing the means

Mean of exponential distribution is 1/lambda (how to do Greek letter?).  In this case 1/0.2 or 5.
Plot histogram of average means and add a line to show the theoretical mean.

```{r plotMeans}
        ## Calculate the distribution and theoretical means and store in a dataframe to be used in ggplot
                distMean <- mean(means)
                theoMean <- 1/lambda

                central_means <- data.frame(statistic = c("Distribution Mean", "Theoretical Mean"),
                             value = c(distMean, theoMean))
                
        ## Plot the average means on a histogram and compare to the theoretical mean
                ggplot(mns, aes(x=means)) + 
                        geom_histogram(col = "white", fill = "#68AFEA") +
                        scale_x_continuous(breaks=seq(0, 10, 1)) +
                        geom_vline(data = central_means, aes(xintercept = value, color = statistic)) +
                        scale_color_manual(values = c("dark blue", "red"), name = NULL) +
                        #geom_text(aes(label = paste(central_means$statistic, " = ", central_means$value)), 
                                  #size = 3, parse = TRUE) +
                        labs(title="Distribution of the averages of 40 exponentials over 1000 simulations", 
                             x = "Average Mean", y = "Frequency")

```

## Comparing the Variances

Variance of the exponential distribution is (1/lambda )^2 or 25 in this case.
Plot histogram of average variances and add a line to show the theoretical variance.

```{r plotVars}
        ## Calculate the distribution and theoretical variances and store in a dataframe to be used in ggplot
                distVar <- mean(vars)
                theoVar <- (1/lambda)^2
                
                central_mean_var <- data.frame(statistic = c("Sample Variance", "Theoretical Variance"),
                             value = c(distVar, theoVar))
                
        ## Plot the average variances on a histogram and compare to the theoretical variance
                ggplot(vrs, aes(x=vars)) + 
                        geom_histogram(col = "white", fill = "#85CD8F") +
                        #scale_x_continuous(breaks=seq(0, 120, 1)) +
                        geom_vline(data = central_mean_var, aes(xintercept = value, color = statistic)) +
                        scale_color_manual(values = c("dark blue", "red"), name = NULL) +
                        labs(title="Distribution of the variances of 40 exponentials over 1000 simulations", 
                             x = "Average Variance", y = "Frequency")
                        
```

## Showing that the simulated distribution is normal

```{r plotDistr}
        
        # Plot the distribution of 1000 random exponentials
                distr1000 <- data.frame(outcome = rexp(1000, lambda))
                distr1000_plot <- ggplot(distr1000, aes(x=outcome)) +
                        geom_histogram(col = "white", fill = "#006FA4") +
                        labs(title = "Distribution of 1000 random exponentials", x = "Random Outcomes", y = "Frequency")

        # Plot the distribution of 1000 averages of 40 random exponentials
                distr1000_40_plot <- ggplot(mns, aes(x=means)) +
                        geom_histogram(aes(y=..density..), col = "white", fill = "#0091D7") +
                        stat_function(fun = dnorm, args = list(mean = 1/lambda, sd = 1/(lambda*sqrt(numexp))), 
                                      size = 2) +
                        labs(title = "Distribution of 1000 averages of 40 random exponentials", 
                             x = "Average Means")
        
        # Display in one panel
                distr_panel <- ggarrange(distr1000_plot, distr1000_40_plot, align = "h")
                
                        

#par(mfrow = c(2,1))
        #hist(rexp(1000, lambda), main = "Distribution of 1000 random exponentials", xlab = "Random Outcomes", 
         #    col = "#006FA4")
        #hist(means, main = "Distribution of 1000 averages")

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
